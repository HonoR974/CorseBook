{"ast":null,"code":"import _asyncToGenerator from \"D:\\\\WorkSpace\\\\DepotGithub\\\\P12\\\\P12\\\\angular\\\\node_modules\\\\@babel\\\\runtime\\\\helpers\\\\esm\\\\asyncToGenerator.js\";\nimport { FormGroup, Validators, FormControl } from '@angular/forms';\nimport { FileAPI } from 'src/app/_class/file-api';\nimport { Publication } from 'src/app/_class/publication';\nimport * as i0 from \"@angular/core\";\nimport * as i1 from \"src/app/_services/token-storage.service\";\nimport * as i2 from \"src/app/_services/publication.service\";\nimport * as i3 from \"src/app/_services/upload-s3.service\";\nimport * as i4 from \"@angular/forms\";\nexport class CreatePublicationComponent {\n  constructor(tokenStorage, publicationService, uploadS3Service) {\n    this.tokenStorage = tokenStorage;\n    this.publicationService = publicationService;\n    this.uploadS3Service = uploadS3Service;\n    this.isLoggedIn = false;\n    this.files = [];\n    this.renderImages = [];\n    this.cheminImage = 'https://testp12.s3.eu-west-3.amazonaws.com/';\n    this.myFiles = [];\n    this.myForm = new FormGroup({\n      contenu: new FormControl('', [Validators.required, Validators.minLength(3)]),\n      file: new FormControl()\n    });\n    this.publication = new Publication();\n    this.fileAPI = new FileAPI();\n  }\n\n  ngOnInit() {\n    if (this.tokenStorage.getToken()) {\n      this.isLoggedIn = true;\n    }\n  }\n\n  get f() {\n    return this.myForm.controls;\n  }\n\n  onFileChange(event) {\n    for (var i = 0; i < event.target.files.length; i++) {\n      this.files.push(event.target.files[i]);\n    }\n  }\n\n  newFileUpdate() {\n    var _this = this;\n\n    return _asyncToGenerator(function* () {\n      for (let i = 0; i < _this.files.length; i += 1) {\n        let file = _this.files[i];\n        let filePath = \"image/\" + file.name; //s3\n\n        try {\n          console.log(\"request upload file \" + filePath); //s3\n\n          let response = yield _this.uploadS3Service.uploadFileS3(file, filePath);\n        } catch (error) {\n          console.log(\"erreur lors de l'envoie de la publication\");\n        } //api\n\n\n        _this.fileAPI.name = file.name;\n        _this.fileAPI.url = _this.cheminImage + filePath;\n        console.log('fileAPI updated ' + _this.fileAPI);\n\n        _this.publication.listFile.push(_this.fileAPI);\n      }\n\n      _this.files = [];\n\n      _this.createPubAPI(_this.publication);\n    })();\n  }\n\n  createPubAPI(publicationRequest) {\n    //le contenu \n    console.log('publicationRequest', publicationRequest);\n    this.publication.contenu = this.myForm.controls['contenu'].value; //l'user \n\n    this.currentUser = this.tokenStorage.getUser();\n    this.publication.username = this.currentUser.username;\n    console.log('publication ', this.publication);\n    this.publicationService.createPublication(this.publication).subscribe(data => {\n      console.log(\"data created \" + data);\n    });\n    window.location.reload();\n  }\n\n}\n\nCreatePublicationComponent.ɵfac = function CreatePublicationComponent_Factory(t) {\n  return new (t || CreatePublicationComponent)(i0.ɵɵdirectiveInject(i1.TokenStorageService), i0.ɵɵdirectiveInject(i2.PublicationService), i0.ɵɵdirectiveInject(i3.UploadS3Service));\n};\n\nCreatePublicationComponent.ɵcmp = /*@__PURE__*/i0.ɵɵdefineComponent({\n  type: CreatePublicationComponent,\n  selectors: [[\"app-create-publication\"]],\n  decls: 11,\n  vars: 1,\n  consts: [[1, \"cadre\", 3, \"formGroup\", \"ngSubmit\"], [1, \"form-group\"], [\"for\", \"contenu\"], [\"formControlName\", \"contenu\", \"id\", \"contenu\", \"type\", \"text\", \"placeholder\", \"Partagez vos experiences\", 1, \"form-control\", \"content\"], [\"for\", \"file\"], [\"formControlName\", \"file\", \"id\", \"file\", \"type\", \"file\", \"multiple\", \"\", 1, \"form-control\", 3, \"change\"], [\"type\", \"submit\", 1, \"btn\", \"btn-primary\", \"button\"]],\n  template: function CreatePublicationComponent_Template(rf, ctx) {\n    if (rf & 1) {\n      i0.ɵɵelementStart(0, \"form\", 0);\n      i0.ɵɵlistener(\"ngSubmit\", function CreatePublicationComponent_Template_form_ngSubmit_0_listener() {\n        return ctx.newFileUpdate();\n      });\n      i0.ɵɵelementStart(1, \"div\", 1);\n      i0.ɵɵelementStart(2, \"label\", 2);\n      i0.ɵɵtext(3, \"Exprimez vous : \");\n      i0.ɵɵelementEnd();\n      i0.ɵɵelement(4, \"input\", 3);\n      i0.ɵɵelementEnd();\n      i0.ɵɵelementStart(5, \"div\", 1);\n      i0.ɵɵelementStart(6, \"label\", 4);\n      i0.ɵɵtext(7, \"Ajoutez des fichiers \");\n      i0.ɵɵelementEnd();\n      i0.ɵɵelementStart(8, \"input\", 5);\n      i0.ɵɵlistener(\"change\", function CreatePublicationComponent_Template_input_change_8_listener($event) {\n        return ctx.onFileChange($event);\n      });\n      i0.ɵɵelementEnd();\n      i0.ɵɵelementEnd();\n      i0.ɵɵelementStart(9, \"button\", 6);\n      i0.ɵɵtext(10, \"Partager\");\n      i0.ɵɵelementEnd();\n      i0.ɵɵelementEnd();\n    }\n\n    if (rf & 2) {\n      i0.ɵɵproperty(\"formGroup\", ctx.myForm);\n    }\n  },\n  directives: [i4.ɵNgNoValidate, i4.NgControlStatusGroup, i4.FormGroupDirective, i4.DefaultValueAccessor, i4.NgControlStatus, i4.FormControlName],\n  styles: [\".cadre[_ngcontent-%COMP%]\\r\\n{\\r\\n\\r\\n    border-radius: 5px;\\r\\n    margin: 20px;\\r\\n    height: 300px;\\r\\n    display: flex;\\r\\n    flex-direction: column;\\r\\n    justify-content: space-around;\\r\\n    text-align: center;\\r\\n\\r\\n   \\r\\n}\\r\\n\\r\\n\\r\\n.create-side[_ngcontent-%COMP%]\\r\\n{\\r\\n    margin: 20px;\\r\\n    display: flex;\\r\\n    flex-direction: row;\\r\\n    justify-content: space-between;\\r\\n}\\r\\n\\r\\n\\r\\n.content[_ngcontent-%COMP%]\\r\\n{\\r\\n    height: 70px;\\r\\n}\\r\\n\\r\\n\\r\\n.button[_ngcontent-%COMP%]\\r\\n{\\r\\n    width: 20%;\\r\\n    display: block;\\r\\n    margin: 0 auto;\\r\\n}\\n/*# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbImNyZWF0ZS1wdWJsaWNhdGlvbi5jb21wb25lbnQuY3NzIl0sIm5hbWVzIjpbXSwibWFwcGluZ3MiOiI7QUFDQTs7O0lBR0ksa0JBQWtCO0lBQ2xCLFlBQVk7SUFDWixhQUFhO0lBQ2IsYUFBYTtJQUNiLHNCQUFzQjtJQUN0Qiw2QkFBNkI7SUFDN0Isa0JBQWtCOzs7QUFHdEI7OztBQUdBOztJQUVJLFlBQVk7SUFDWixhQUFhO0lBQ2IsbUJBQW1CO0lBQ25CLDhCQUE4QjtBQUNsQzs7O0FBR0E7O0lBRUksWUFBWTtBQUNoQjs7O0FBRUE7O0lBRUksVUFBVTtJQUNWLGNBQWM7SUFDZCxjQUFjO0FBQ2xCIiwiZmlsZSI6ImNyZWF0ZS1wdWJsaWNhdGlvbi5jb21wb25lbnQuY3NzIiwic291cmNlc0NvbnRlbnQiOlsiXHJcbi5jYWRyZVxyXG57XHJcblxyXG4gICAgYm9yZGVyLXJhZGl1czogNXB4O1xyXG4gICAgbWFyZ2luOiAyMHB4O1xyXG4gICAgaGVpZ2h0OiAzMDBweDtcclxuICAgIGRpc3BsYXk6IGZsZXg7XHJcbiAgICBmbGV4LWRpcmVjdGlvbjogY29sdW1uO1xyXG4gICAganVzdGlmeS1jb250ZW50OiBzcGFjZS1hcm91bmQ7XHJcbiAgICB0ZXh0LWFsaWduOiBjZW50ZXI7XHJcblxyXG4gICBcclxufVxyXG5cclxuXHJcbi5jcmVhdGUtc2lkZVxyXG57XHJcbiAgICBtYXJnaW46IDIwcHg7XHJcbiAgICBkaXNwbGF5OiBmbGV4O1xyXG4gICAgZmxleC1kaXJlY3Rpb246IHJvdztcclxuICAgIGp1c3RpZnktY29udGVudDogc3BhY2UtYmV0d2VlbjtcclxufVxyXG5cclxuXHJcbi5jb250ZW50XHJcbntcclxuICAgIGhlaWdodDogNzBweDtcclxufVxyXG5cclxuLmJ1dHRvblxyXG57XHJcbiAgICB3aWR0aDogMjAlO1xyXG4gICAgZGlzcGxheTogYmxvY2s7XHJcbiAgICBtYXJnaW46IDAgYXV0bztcclxufSJdfQ== */\"]\n});","map":{"version":3,"sources":["D:/WorkSpace/DepotGithub/P12/P12/angular/src/app/_components/create-publication/create-publication.component.ts"],"names":["FormGroup","Validators","FormControl","FileAPI","Publication","i0","i1","i2","i3","i4","CreatePublicationComponent","constructor","tokenStorage","publicationService","uploadS3Service","isLoggedIn","files","renderImages","cheminImage","myFiles","myForm","contenu","required","minLength","file","publication","fileAPI","ngOnInit","getToken","f","controls","onFileChange","event","i","target","length","push","newFileUpdate","filePath","name","console","log","response","uploadFileS3","error","url","listFile","createPubAPI","publicationRequest","value","currentUser","getUser","username","createPublication","subscribe","data","window","location","reload","ɵfac","CreatePublicationComponent_Factory","t","ɵɵdirectiveInject","TokenStorageService","PublicationService","UploadS3Service","ɵcmp","ɵɵdefineComponent","type","selectors","decls","vars","consts","template","CreatePublicationComponent_Template","rf","ctx","ɵɵelementStart","ɵɵlistener","CreatePublicationComponent_Template_form_ngSubmit_0_listener","ɵɵtext","ɵɵelementEnd","ɵɵelement","CreatePublicationComponent_Template_input_change_8_listener","$event","ɵɵproperty","directives","ɵNgNoValidate","NgControlStatusGroup","FormGroupDirective","DefaultValueAccessor","NgControlStatus","FormControlName","styles"],"mappings":"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","sourcesContent":["import { FormGroup, Validators, FormControl, } from '@angular/forms';\r\nimport { FileAPI } from 'src/app/_class/file-api';\r\nimport { Publication } from 'src/app/_class/publication';\r\nimport * as i0 from \"@angular/core\";\r\nimport * as i1 from \"src/app/_services/token-storage.service\";\r\nimport * as i2 from \"src/app/_services/publication.service\";\r\nimport * as i3 from \"src/app/_services/upload-s3.service\";\r\nimport * as i4 from \"@angular/forms\";\r\nexport class CreatePublicationComponent {\r\n    constructor(tokenStorage, publicationService, uploadS3Service) {\r\n        this.tokenStorage = tokenStorage;\r\n        this.publicationService = publicationService;\r\n        this.uploadS3Service = uploadS3Service;\r\n        this.isLoggedIn = false;\r\n        this.files = [];\r\n        this.renderImages = [];\r\n        this.cheminImage = 'https://testp12.s3.eu-west-3.amazonaws.com/';\r\n        this.myFiles = [];\r\n        this.myForm = new FormGroup({\r\n            contenu: new FormControl('', [\r\n                Validators.required,\r\n                Validators.minLength(3),\r\n            ]),\r\n            file: new FormControl(),\r\n        });\r\n        this.publication = new Publication();\r\n        this.fileAPI = new FileAPI();\r\n    }\r\n    ngOnInit() {\r\n        if (this.tokenStorage.getToken()) {\r\n            this.isLoggedIn = true;\r\n        }\r\n    }\r\n    get f() {\r\n        return this.myForm.controls;\r\n    }\r\n    onFileChange(event) {\r\n        for (var i = 0; i < event.target.files.length; i++) {\r\n            this.files.push(event.target.files[i]);\r\n        }\r\n    }\r\n    async newFileUpdate() {\r\n        for (let i = 0; i < this.files.length; i += 1) {\r\n            let file = this.files[i];\r\n            let filePath = \"image/\" + file.name;\r\n            //s3\r\n            try {\r\n                console.log(\"request upload file \" + filePath);\r\n                //s3\r\n                let response = await this.uploadS3Service.uploadFileS3(file, filePath);\r\n            }\r\n            catch (error) {\r\n                console.log(\"erreur lors de l'envoie de la publication\");\r\n            }\r\n            //api\r\n            this.fileAPI.name = file.name;\r\n            this.fileAPI.url = this.cheminImage + filePath;\r\n            console.log('fileAPI updated ' + this.fileAPI);\r\n            this.publication.listFile.push(this.fileAPI);\r\n        }\r\n        this.files = [];\r\n        this.createPubAPI(this.publication);\r\n    }\r\n    createPubAPI(publicationRequest) {\r\n        //le contenu \r\n        console.log('publicationRequest', publicationRequest);\r\n        this.publication.contenu = this.myForm.controls['contenu'].value;\r\n        //l'user \r\n        this.currentUser = this.tokenStorage.getUser();\r\n        this.publication.username = this.currentUser.username;\r\n        console.log('publication ', this.publication);\r\n        this.publicationService\r\n            .createPublication(this.publication)\r\n            .subscribe((data) => {\r\n            console.log(\"data created \" + data);\r\n        });\r\n        window.location.reload();\r\n    }\r\n}\r\nCreatePublicationComponent.ɵfac = function CreatePublicationComponent_Factory(t) { return new (t || CreatePublicationComponent)(i0.ɵɵdirectiveInject(i1.TokenStorageService), i0.ɵɵdirectiveInject(i2.PublicationService), i0.ɵɵdirectiveInject(i3.UploadS3Service)); };\r\nCreatePublicationComponent.ɵcmp = /*@__PURE__*/ i0.ɵɵdefineComponent({ type: CreatePublicationComponent, selectors: [[\"app-create-publication\"]], decls: 11, vars: 1, consts: [[1, \"cadre\", 3, \"formGroup\", \"ngSubmit\"], [1, \"form-group\"], [\"for\", \"contenu\"], [\"formControlName\", \"contenu\", \"id\", \"contenu\", \"type\", \"text\", \"placeholder\", \"Partagez vos experiences\", 1, \"form-control\", \"content\"], [\"for\", \"file\"], [\"formControlName\", \"file\", \"id\", \"file\", \"type\", \"file\", \"multiple\", \"\", 1, \"form-control\", 3, \"change\"], [\"type\", \"submit\", 1, \"btn\", \"btn-primary\", \"button\"]], template: function CreatePublicationComponent_Template(rf, ctx) { if (rf & 1) {\r\n        i0.ɵɵelementStart(0, \"form\", 0);\r\n        i0.ɵɵlistener(\"ngSubmit\", function CreatePublicationComponent_Template_form_ngSubmit_0_listener() { return ctx.newFileUpdate(); });\r\n        i0.ɵɵelementStart(1, \"div\", 1);\r\n        i0.ɵɵelementStart(2, \"label\", 2);\r\n        i0.ɵɵtext(3, \"Exprimez vous : \");\r\n        i0.ɵɵelementEnd();\r\n        i0.ɵɵelement(4, \"input\", 3);\r\n        i0.ɵɵelementEnd();\r\n        i0.ɵɵelementStart(5, \"div\", 1);\r\n        i0.ɵɵelementStart(6, \"label\", 4);\r\n        i0.ɵɵtext(7, \"Ajoutez des fichiers \");\r\n        i0.ɵɵelementEnd();\r\n        i0.ɵɵelementStart(8, \"input\", 5);\r\n        i0.ɵɵlistener(\"change\", function CreatePublicationComponent_Template_input_change_8_listener($event) { return ctx.onFileChange($event); });\r\n        i0.ɵɵelementEnd();\r\n        i0.ɵɵelementEnd();\r\n        i0.ɵɵelementStart(9, \"button\", 6);\r\n        i0.ɵɵtext(10, \"Partager\");\r\n        i0.ɵɵelementEnd();\r\n        i0.ɵɵelementEnd();\r\n    } if (rf & 2) {\r\n        i0.ɵɵproperty(\"formGroup\", ctx.myForm);\r\n    } }, directives: [i4.ɵNgNoValidate, i4.NgControlStatusGroup, i4.FormGroupDirective, i4.DefaultValueAccessor, i4.NgControlStatus, i4.FormControlName], styles: [\".cadre[_ngcontent-%COMP%]\\r\\n{\\r\\n\\r\\n    border-radius: 5px;\\r\\n    margin: 20px;\\r\\n    height: 300px;\\r\\n    display: flex;\\r\\n    flex-direction: column;\\r\\n    justify-content: space-around;\\r\\n    text-align: center;\\r\\n\\r\\n   \\r\\n}\\r\\n\\r\\n\\r\\n.create-side[_ngcontent-%COMP%]\\r\\n{\\r\\n    margin: 20px;\\r\\n    display: flex;\\r\\n    flex-direction: row;\\r\\n    justify-content: space-between;\\r\\n}\\r\\n\\r\\n\\r\\n.content[_ngcontent-%COMP%]\\r\\n{\\r\\n    height: 70px;\\r\\n}\\r\\n\\r\\n\\r\\n.button[_ngcontent-%COMP%]\\r\\n{\\r\\n    width: 20%;\\r\\n    display: block;\\r\\n    margin: 0 auto;\\r\\n}\\n/*# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbImNyZWF0ZS1wdWJsaWNhdGlvbi5jb21wb25lbnQuY3NzIl0sIm5hbWVzIjpbXSwibWFwcGluZ3MiOiI7QUFDQTs7O0lBR0ksa0JBQWtCO0lBQ2xCLFlBQVk7SUFDWixhQUFhO0lBQ2IsYUFBYTtJQUNiLHNCQUFzQjtJQUN0Qiw2QkFBNkI7SUFDN0Isa0JBQWtCOzs7QUFHdEI7OztBQUdBOztJQUVJLFlBQVk7SUFDWixhQUFhO0lBQ2IsbUJBQW1CO0lBQ25CLDhCQUE4QjtBQUNsQzs7O0FBR0E7O0lBRUksWUFBWTtBQUNoQjs7O0FBRUE7O0lBRUksVUFBVTtJQUNWLGNBQWM7SUFDZCxjQUFjO0FBQ2xCIiwiZmlsZSI6ImNyZWF0ZS1wdWJsaWNhdGlvbi5jb21wb25lbnQuY3NzIiwic291cmNlc0NvbnRlbnQiOlsiXHJcbi5jYWRyZVxyXG57XHJcblxyXG4gICAgYm9yZGVyLXJhZGl1czogNXB4O1xyXG4gICAgbWFyZ2luOiAyMHB4O1xyXG4gICAgaGVpZ2h0OiAzMDBweDtcclxuICAgIGRpc3BsYXk6IGZsZXg7XHJcbiAgICBmbGV4LWRpcmVjdGlvbjogY29sdW1uO1xyXG4gICAganVzdGlmeS1jb250ZW50OiBzcGFjZS1hcm91bmQ7XHJcbiAgICB0ZXh0LWFsaWduOiBjZW50ZXI7XHJcblxyXG4gICBcclxufVxyXG5cclxuXHJcbi5jcmVhdGUtc2lkZVxyXG57XHJcbiAgICBtYXJnaW46IDIwcHg7XHJcbiAgICBkaXNwbGF5OiBmbGV4O1xyXG4gICAgZmxleC1kaXJlY3Rpb246IHJvdztcclxuICAgIGp1c3RpZnktY29udGVudDogc3BhY2UtYmV0d2VlbjtcclxufVxyXG5cclxuXHJcbi5jb250ZW50XHJcbntcclxuICAgIGhlaWdodDogNzBweDtcclxufVxyXG5cclxuLmJ1dHRvblxyXG57XHJcbiAgICB3aWR0aDogMjAlO1xyXG4gICAgZGlzcGxheTogYmxvY2s7XHJcbiAgICBtYXJnaW46IDAgYXV0bztcclxufSJdfQ== */\"] });\r\n"]},"metadata":{},"sourceType":"module"}